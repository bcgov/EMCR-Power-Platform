
CREATE VIEW [EMBCPROD].[V_TIP_INTEL_SOI_REPORT] (
   UNIQUE_KEY, 
   HISTORY_VERSION, 
   DELETED, 
   TIP_INTEL_NUMBER, 
   TIP_INTEL_AGENCY, 
   TIP_INTEL_DATETIME, 
   TIP_INTEL_LEADAGENCY, 
   TIP_INTEL_SYNOPSIS, 
   TIP_INTEL_STATUS, 
   CREATION_DATE, 
   CREATED_BY, 
   MODIFICATION_DATE, 
   MODIFIED_BY, 
   SOI_KEY, 
   TIP_INTEL_PSI_REPORT_TYPE, 
   COL_TIPPSIPROTECTED, 
   COL_TIPPSICREDIBILITY, 
   COL_TIPPSIVALIDITY, 
   COL_TIPPSILASTNAME, 
   COL_TIPPSIFIRSTNAME, 
   SITE_NAME, 
   SITE_TYPE, 
   STREET_ADDRESS, 
   APT_LOT_NO, 
   CITY, 
   COUNTRY_NAME, 
   COUNTY_NAME, 
   GEO_AREA, 
   STATE_NAME, 
   ZIP_CODE, 
   INTERSECTION_STREET1, 
   INTERSECTION_STREET2, 
   ADDITIONAL_INFO, 
   SHOW_ON_MAP, 
   LATITUDE, 
   LONGITUDE, 
   F_LATITUDE, 
   F_LONGITUDE, 
   GEO_LOCATED_BY)
AS 
   SELECT 
      TS.UNIQUE_KEY, 
      TS.HISTORY_VERSION, 
      TS.DELETED, 
      TS.TIP_INTEL_NUMBER, 
      TS.TIP_INTEL_AGENCY, 
      TS.TIP_INTEL_DATETIME, 
      TS.TIP_INTEL_LEADAGENCY, 
      TS.TIP_INTEL_SYNOPSIS, 
      TS.TIP_INTEL_STATUS, 
      TS.CREATION_DATE, 
      TS.CREATED_BY, 
      TS.MODIFICATION_DATE, 
      TS.MODIFIED_BY, 
      PSI.UNIQUE_KEY AS SOI_KEY, 
      PSI.TIP_INTEL_PSI_REPORT_TYPE, 
      PSI.COL_TIPPSIPROTECTED, 
      PSI.COL_TIPPSICREDIBILITY, 
      PSI.COL_TIPPSIVALIDITY, 
      PSI.COL_TIPPSILASTNAME, 
      PSI.COL_TIPPSIFIRSTNAME, 
      PSI.SITE_NAME, 
      PSI.SITE_TYPE, 
      PSI.STREET_ADDRESS, 
      PSI.APT_LOT_NO, 
      PSI.CITY, 
      PSI.COUNTRY_NAME, 
      PSI.COUNTY_NAME, 
      PSI.GEO_AREA, 
      PSI.STATE_NAME, 
      PSI.ZIP_CODE, 
      PSI.INTERSECTION_STREET1, 
      PSI.INTERSECTION_STREET2, 
      PSI.ADDITIONAL_INFO, 
      PSI.SHOW_ON_MAP, 
      PSI.LATITUDE, 
      PSI.LONGITUDE, 
      PSI.F_LATITUDE, 
      PSI.F_LONGITUDE, 
      PSI.GEO_LOCATED_BY
   FROM 
      EMBCPROD.V_TIP_INTEL_REPORT  AS TS 
         LEFT JOIN 
         (
            SELECT 
               V_TIP_INTEL_PSI_REPORT.COL_TIPINTELPARENTID, 
               V_TIP_INTEL_PSI_REPORT.UNIQUE_KEY, 
               V_TIP_INTEL_PSI_REPORT.TIP_INTEL_PSI_REPORT_TYPE, 
               V_TIP_INTEL_PSI_REPORT.COL_TIPPSIPROTECTED, 
               V_TIP_INTEL_PSI_REPORT.COL_TIPPSICREDIBILITY, 
               V_TIP_INTEL_PSI_REPORT.COL_TIPPSIVALIDITY, 
               V_TIP_INTEL_PSI_REPORT.COL_TIPPSILASTNAME, 
               V_TIP_INTEL_PSI_REPORT.COL_TIPPSIFIRSTNAME, 
               V_TIP_INTEL_PSI_REPORT.SITE_NAME, 
               V_TIP_INTEL_PSI_REPORT.SITE_TYPE, 
               V_TIP_INTEL_PSI_REPORT.STREET_ADDRESS, 
               V_TIP_INTEL_PSI_REPORT.APT_LOT_NO, 
               V_TIP_INTEL_PSI_REPORT.CITY, 
               V_TIP_INTEL_PSI_REPORT.COUNTRY_NAME, 
               V_TIP_INTEL_PSI_REPORT.COUNTY_NAME, 
               V_TIP_INTEL_PSI_REPORT.GEO_AREA, 
               V_TIP_INTEL_PSI_REPORT.STATE_NAME, 
               V_TIP_INTEL_PSI_REPORT.ZIP_CODE, 
               V_TIP_INTEL_PSI_REPORT.INTERSECTION_STREET1, 
               V_TIP_INTEL_PSI_REPORT.INTERSECTION_STREET2, 
               V_TIP_INTEL_PSI_REPORT.ADDITIONAL_INFO, 
               V_TIP_INTEL_PSI_REPORT.SHOW_ON_MAP, 
               V_TIP_INTEL_PSI_REPORT.LATITUDE, 
               V_TIP_INTEL_PSI_REPORT.LONGITUDE, 
               V_TIP_INTEL_PSI_REPORT.F_LATITUDE, 
               V_TIP_INTEL_PSI_REPORT.F_LONGITUDE, 
               V_TIP_INTEL_PSI_REPORT.GEO_LOCATED_BY
            FROM EMBCPROD.V_TIP_INTEL_PSI_REPORT
            WHERE V_TIP_INTEL_PSI_REPORT.HISTORY_VERSION = 'No' AND V_TIP_INTEL_PSI_REPORT.DELETED = 'No'
         )  AS PSI 
         ON TS.TIP_INTEL_NUMBER = PSI.COL_TIPINTELPARENTID

GO
EXECUTE sp_addextendedproperty @name = N'MS_SSMA_SOURCE', @value = N'EMBCPROD.V_TIP_INTEL_SOI_REPORT', @level0type = N'SCHEMA', @level0name = N'EMBCPROD', @level1type = N'VIEW', @level1name = N'V_TIP_INTEL_SOI_REPORT';

