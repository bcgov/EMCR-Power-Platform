
CREATE VIEW [EMBCPROD].[V_CUSTOM_FORMS] (
   FREVVO_ID, 
   GLOBAL_REPORT_ID, 
   FORM_NAME, 
   INSTANCE_ID, 
   REPORT_ID, 
   INSTANCE_STATUS, 
   CUSTOM_FORM_V1, 
   FREVVO_XML_DATA, 
   CUSTOM_FORM_V2, 
   CUSTOM_FORM_V3, 
   CUSTOM_FORM_V4, 
   CUSTOM_FORM_V5, 
   CREATION_DATE, 
   MODIFIED_BY, 
   MODIFICATION_DATE, 
   STATUS, 
   IS_DELETED, 
   IS_STAND_ALONE, 
   CUSTOM_FORM_STATUS_ID, 
   DISPLAY_NAME, 
   REPORT_TYPE_ID)
AS 
   SELECT 
      TC.FREVVO_ID, 
      REPT.GLOBAL_REPORT_ID, 
      TCF.FORM_NAME, 
      TC.INSTANCE_ID, 
      REPT.REPORT_ID, 
      TC.INSTANCE_STATUS, 
      TC.CUSTOM_FORM_V1, 
      TC.FREVVO_XML_DATA, 
      TC.CUSTOM_FORM_V2, 
      TC.CUSTOM_FORM_V3, 
      TC.CUSTOM_FORM_V4, 
      TC.CUSTOM_FORM_V5, 
      REPT.CREATION_DATE, 
      REPT.MODIFIED_BY, 
      REPT.MODIFICATION_DATE, 
      REPT.STATUS, 
      TCF.IS_DELETED, 
      TCF.IS_STAND_ALONE, 
      TCF.CUSTOM_FORM_STATUS_ID, 
      TCF.DISPLAY_NAME, 
      CFR.REPORT_TYPE_ID
   FROM 
      EMBCPROD.TBL_REPORT  AS REPT, 
      EMBCPROD.TBL_CUSTOM_FORM  AS TCF, 
      EMBCPROD.TBL_CUSTOM_FORM_INSTANCE  AS TC 
         LEFT JOIN /*LEFT JOIN TBL_CUSTOM_FORM_REPORT CFR ON TC.CUSTOM_FORM_ID = CFR.REPORT_TYPE_ID*/EMBCPROD.TBL_CUSTOM_FORM_REPORT  AS CFR 
         ON TC.CUSTOM_FORM_ID = CFR.CUSTOM_FORM_ID
   WHERE 
      REPT.REPORT_TYPE = 'custom_form' AND 
      upper(CFR.REPORT_TYPE_ID) = 'STANDALONE' AND 
      TC.GLOBAL_REPORT_ID = REPT.GLOBAL_REPORT_ID AND 
      TCF.CUSTOM_FORM_ID = TC.CUSTOM_FORM_ID AND 
      TC.FREVVO_XML_DATA IS NOT NULL

GO
EXECUTE sp_addextendedproperty @name = N'MS_SSMA_SOURCE', @value = N'EMBCPROD.V_CUSTOM_FORMS', @level0type = N'SCHEMA', @level0name = N'EMBCPROD', @level1type = N'VIEW', @level1name = N'V_CUSTOM_FORMS';

