
CREATE VIEW [EMBCPROD].[V_USER_VIEW] (
   USER_ID, 
   ASSIGNED_TO, 
   GROUP_NAME, 
   WEB_PAGE_LINK, 
   CREATION_DATE, 
   MODIFICATION_DATE)
AS 
   SELECT 
      UV.USER_ID, 
      UV.ASSIGNED_TO, 
      G.GROUP_NAME, 
      REPT.WEB_PAGE_LINK, 
      REPT.CREATION_DATE, 
      REPT.MODIFICATION_DATE
   FROM 
      EMBCPROD.TBL_USER  AS UV 
         LEFT JOIN EMBCPROD.TBL_REPORT  AS REPT 
         ON UV.USER_ID = REPT.GLOBAL_REPORT_ID AND REPT.STATUS = 'A' 
         LEFT JOIN EMBCPROD.TBL_USER_GROUP  AS GR 
         ON REPT.REPORT_ID = GR.USER_ID 
         LEFT JOIN (EMBCPROD.TBL_GROUP  AS G 
         JOIN EMBCPROD.TBL_REPORT  AS RG 
         ON RG.GLOBAL_REPORT_ID = G.GROUP_ID AND RG.STATUS = 'A') 
         ON GR.GROUP_ID = RG.REPORT_ID
   WHERE UV.USER_ID = REPT.GLOBAL_REPORT_ID

GO
EXECUTE sp_addextendedproperty @name = N'MS_SSMA_SOURCE', @value = N'EMBCPROD.V_USER_VIEW', @level0type = N'SCHEMA', @level0name = N'EMBCPROD', @level1type = N'VIEW', @level1name = N'V_USER_VIEW';

