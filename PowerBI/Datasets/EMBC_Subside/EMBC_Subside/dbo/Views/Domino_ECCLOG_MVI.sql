CREATE    VIEW dbo.Domino_ECCLOG_MVI AS  SELECT *  FROM (   SELECT j.DocID as 'DocumentID', b.Name, ISNULL(b.Text, '') as [Text]   FROM dbo.DominoData j   CROSS APPLY OPENJSON (FormData) a   CROSS APPLY OPENJSON (a.value)    WITH (    [Name] VARCHAR(50)      ,[Text] VARCHAR(MAX)      ,[Values] NVARCHAR(MAX) AS JSON   ) b    where FormName = 'MVI'     and isJson(FormData) =1  ) App  PIVOT   (    MAX([Text])  FOR [Name]IN ([$Conflict],[$REF],[$Revisions],[$UpdatedBy],[$WebFlags],[AltContactNo1],[AltContactNo1Type],[AltContactNo2],[AltContactNo2Type],[ASENumber],[AssociatedEvent],[AutoExtricationJAWS],[BCASNo],[Caller],[CallerAgency],[CISMRequested],[CliffRescue],[CopiedToEM2000],[Delete],[docID],[ESSLevel],[ESSResponse],[Evacuees],[FireDeptNo],[Form],[FormName],[HighwayFireSupression],[INAC],[IncidentArea],[IncidentDateTime],[IncidentDateTimeConcluded],[IncidentDetails],[IncidentLocation],[IncidentNumber],[IncidentRegion],[IncidentStatus],[IncidentSubject],[IncidentSubType],[IncidentTimeLogged],[IncidentType],[JournalVoucherTo],[NtfReportData],[OriginalModTime],[ORIGINALSERVICE],[OtherTA],[OtherTaskingAgencyNo],[ParksCdnNo],[PrimaryContactNo],[PrimaryContactNoType],[PrimaryTaskingAgency],[PtpReportData],[RCCNo],[RCMPNo],[ReportAuthor],[ReportAuthorPosition],[ReportDisplayDate],[SuppressReport],[TaskCategory],[TaskDollarsAssigned],[TaskDollarsIssuedTo],[TaskDollarsRequestorPosition],[TaskNumber],[UniversalID])) as PivotTable
