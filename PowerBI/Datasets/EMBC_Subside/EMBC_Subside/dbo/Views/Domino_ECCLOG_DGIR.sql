CREATE    VIEW dbo.Domino_ECCLOG_DGIR AS  SELECT *  FROM (   SELECT j.DocID as 'DocumentID', b.Name, ISNULL(b.Text, '') as [Text]   FROM dbo.DominoData j   CROSS APPLY OPENJSON (FormData) a   CROSS APPLY OPENJSON (a.value)    WITH (    [Name] VARCHAR(50)      ,[Text] VARCHAR(MAX)      ,[Values] NVARCHAR(MAX) AS JSON   ) b    where FormName = 'DGIR'     and isJson(FormData) =1  ) App  PIVOT   (    MAX([Text])  FOR [Name]IN ([$Conflict],[$ConflictAction],[$ConflictItems],[$ExternalFields],[$REF],[$RespondedTo],[$Revisions],[$UpdatedBy],[AffectedEnvironment],[AltCallerBNo],[AltCallerBType],[AltContactNo1],[AltContactNo1Type],[Amount1],[Amount2],[ASENumber],[AssociatedEvent],[Caller],[CallerAgency],[CallerBAgency],[CallerBDateTimeCalled],[CallerBName],[CallerBNo],[CallerBNoType],[CallerLocation],[CallerLocation2],[Code2],[CompanyProperty],[CopiedToEM2000],[Copy],[Delete],[docID],[EMAILTRANSFERTOEPS],[ESDBlockValve],[FaCTS_Update],[Form],[FormName],[GasQuestion1],[GasQuestion2],[H2S],[HoldEPSTransfer],[INAC],[IncidentArea],[INCIDENTCURRENT],[IncidentDateTime],[IncidentDetails],[IncidentLocation],[IncidentNotifiedTime],[IncidentNumber],[IncidentRegion],[IncidentResponse],[IncidentStatus],[IncidentSubject],[IncidentSubType],[IncidentTimeLogged],[IncidentTimeLoggedTEXT],[IncidentType],[IncidentUpdateCount],[JournalVoucherTo],[Jurisdiction],[LevelOfThreat],[LineLength],[LoTComments],[LoTScore],[Material1],[Material2],[MCTSNo],[MedAssist],[MELPRegion],[MVA],[NtfReportData],[OGCType],[OriginalModTime],[OriginalTimeLogged],[OtherEnvironmentDescription],[OtherSpillType],[PrimaryContactNo],[PrimaryContactNoType],[ReportAuthor],[ReportAuthorPosition],[ReportDisplayDate],[REPORTTRANSFERSTATUS],[Sector],[Spiller],[SpillType],[SuppressReport],[TaskCategory],[TaskDollarsAssigned],[TaskDollarsIssuedTo],[TaskDollarsRequestorPosition],[TaskNumber],[TimeZone],[TransferToEC],[TransferToEPS],[UniversalID])) as PivotTable
