CREATE    VIEW dbo.Domino_ECCLOG_ERS AS  SELECT *  FROM (   SELECT j.DocID as 'DocumentID', b.Name, ISNULL(b.Text, '') as [Text]   FROM dbo.DominoData j   CROSS APPLY OPENJSON (FormData) a   CROSS APPLY OPENJSON (a.value)    WITH (    [Name] VARCHAR(50)      ,[Text] VARCHAR(MAX)      ,[Values] NVARCHAR(MAX) AS JSON   ) b    where FormName = 'ERS'     and isJson(FormData) =1  ) App  PIVOT   (    MAX([Text])  FOR [Name]IN ([$Conflict],[$ConflictAction],[$HFFlags],[$KeepPrivate],[$REF],[$RespondedTo],[$Revisions],[$UpdatedBy],[Address],[AltContactNo1],[AltContactNo1Type],[AltContactNo2],[AltContactNo2Type],[AltContactNo3],[AltContactNo3Type],[Area],[Build],[Build_1],[Build_2],[Build_3],[Build_4],[Caller],[City],[Clothing],[Clothing_1],[Clothing_2],[Clothing_3],[Clothing_4],[Complexion],[Complexion_1],[Complexion_2],[Complexion_3],[Complexion_4],[COORSNo],[CopiedToEM2000],[Copy],[Delete],[District],[docID],[Email],[Eyes],[Eyes_1],[Eyes_2],[Eyes_3],[Eyes_4],[FaCTS_New],[FaCTS_Update],[Features],[Features_1],[Features_2],[Features_3],[Features_4],[Form],[FormName],[Glasses],[Glasses_1],[Glasses_2],[Glasses_3],[Glasses_4],[Hair],[Hair_1],[Hair_2],[Hair_3],[Hair_4],[Height],[Height_1],[Height_2],[Height_3],[Height_4],[INCIDENTCURRENT],[IncidentNumber],[IncidentSubject],[IncidentSubType],[IncidentTimeLogged],[IncidentType],[NtfReportData],[OccurrenceRegion],[OffenseDetails],[OffenseLocation],[OffenseWitnessed],[OriginalModTime],[PostalCode],[PrimaryContactNo],[PrimaryContactNoType],[Race],[Race_1],[Race_2],[Race_3],[Race_4],[Readers],[Recipients],[Recipients2],[ReferredBy],[ReportAuthor],[ReportAuthorPosition],[ReportDisplayDate],[Sex],[Sex_1],[Sex_2],[Sex_3],[Sex_4],[Smoker],[Smoker_1],[Smoker_2],[Smoker_3],[Smoker_4],[TaskCategory],[UniversalID],[Vehicle],[Vehicle_1],[Vehicle_2],[Vehicle_3],[Vehicle_4],[ViolationDate],[ViolationDateTEXT],[ViolationDetails],[ViolationDetails_1],[ViolationDetails_2],[ViolationDetails_3],[ViolationDetails_4],[ViolationProgress],[ViolationTime],[ViolationType],[ViolatorName],[ViolatorName_1],[ViolatorName_2],[ViolatorName_3],[ViolatorName_4],[Weapons],[Weapons_1],[Weapons_2],[Weapons_3],[Weapons_4],[Weight],[Weight_1],[Weight_2],[Weight_3],[Weight_4])) as PivotTable
