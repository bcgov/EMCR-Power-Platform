
CREATE      VIEW [dbo].[Domino_ECCLOG_TaskNo] 
AS  
SELECT *  
FROM (   SELECT j.DocID as 'DocumentID', b.Name, ISNULL(b.Text, '') as [Text]   FROM dbo.DominoData j   
CROSS APPLY OPENJSON (FormData) a   
CROSS APPLY OPENJSON (a.value)    
WITH (    [Name] VARCHAR(50)      ,[Text] VARCHAR(MAX)      ,[Values] NVARCHAR(MAX) AS JSON   ) b    
where FormName = 'TaskNo'     and isJson(FormData) =1  AND IgnoreDocument = 0) App  PIVOT   (    MAX([Text])   FOR [Name]IN ([$Conflict],[$REF],[$Revisions],[$UpdatedBy],[ActivitiesCovered],[Allocated],[DocCreated],[DocCreatedBy],[DocUpdated],[DocUpdatedBy],[EA100amount],[EA100date],[EA100financename],[EA100reason],[EA10amount],[EA10date],[EA10financename],[EA10reason],[EA11amount],[EA11date],[EA11financename],[EA11reason],[EA12amount],[EA12date],[EA12financename],[EA12reason],[EA13amount],[EA13date],[EA13financename],[EA13reason],[EA14amount],[EA14date],[EA14financename],[EA14reason],[EA15amount],[EA15date],[EA15financename],[EA15reason],[EA16amount],[EA16date],[EA16financename],[EA16reason],[EA17amount],[EA17date],[EA17financename],[EA17reason],[EA18amount],[EA18date],[EA18financename],[EA18reason],[EA19amount],[EA19date],[EA19financename],[EA19reason],[EA1amount],[EA1date],[EA1financename],[EA1reason],[EA20amount],[EA20date],[EA20financename],[EA20reason],[EA21amount],[EA21date],[EA21financename],[EA21reason],[EA22amount],[EA22date],[EA22financename],[EA22reason],[EA23amount],[EA23date],[EA23financename],[EA23reason],[EA24amount],[EA24date],[EA24financename],[EA24reason],[EA25amount],[EA25date],[EA25financename],[EA25reason],[EA26amount],[EA26date],[EA26financename],[EA26reason],[EA27amount],[EA27date],[EA27financename],[EA27reason],[EA28amount],[EA28date],[EA28financename],[EA28reason],[EA29amount],[EA29date],[EA29financename],[EA29reason],[EA2amount],[EA2date],[EA2financename],[EA2reason],[EA30amount],[EA30date],[EA30financename],[EA30reason],[EA31amount],[EA31date],[EA31financename],[EA31reason],[EA32amount],[EA32date],[EA32financename],[EA32reason],[EA33amount],[EA33date],[EA33financename],[EA33reason],[EA34amount],[EA34date],[EA34financename],[EA34reason],[EA35amount],[EA35date],[EA35financename],[EA35reason],[EA36amount],[EA36date],[EA36financename],[EA36reason],[EA37amount],[EA37date],[EA37financename],[EA37reason],[EA38amount],[EA38date],[EA38financename],[EA38reason],[EA39amount],[EA39date],[EA39financename],[EA39reason],[EA3amount],[EA3date],[EA3financename],[EA3reason],[EA40amount],[EA40date],[EA40financename],[EA40reason],[EA41amount],[EA41date],[EA41financename],[EA41reason],[EA42amount],[EA42date],[EA42financename],[EA42reason],[EA43amount],[EA43date],[EA43financename],[EA43reason],[EA44amount],[EA44date],[EA44financename],[EA44reason],[EA45amount],[EA45date],[EA45financename],[EA45reason],[EA46amount],[EA46date],[EA46financename],[EA46reason],[EA47amount],[EA47date],[EA47financename],[EA47reason],[EA48amount],[EA48date],[EA48financename],[EA48reason],[EA49amount],[EA49date],[EA49financename],[EA49reason],[EA4amount],[EA4date],[EA4financename],[EA4reason],[EA50amount],[EA50date],[EA50financename],[EA50reason],[EA51amount],[EA51date],[EA51financename],[EA51reason],[EA52amount],[EA52date],[EA52financename],[EA52reason],[EA53amount],[EA53date],[EA53financename],[EA53reason],[EA54amount],[EA54date],[EA54financename],[EA54reason],[EA55amount],[EA55date],[EA55financename],[EA55reason],[EA56amount],[EA56date],[EA56financename],[EA56reason],[EA57amount],[EA57date],[EA57financename],[EA57reason],[EA58amount],[EA58date],[EA58financename],[EA58reason],[EA59amount],[EA59date],[EA59financename],[EA59reason],[EA5amount],[EA5date],[EA5financename],[EA5reason],[EA60amount],[EA60date],[EA60financename],[EA60reason],[EA61amount],[EA61date],[EA61financename],[EA61reason],[EA62amount],[EA62date],[EA62financename],[EA62reason],[EA63amount],[EA63date],[EA63financename],[EA63reason],[EA64amount],[EA64date],[EA64financename],[EA64reason],[EA65amount],[EA65date],[EA65financename],[EA65reason],[EA66amount],[EA66date],[EA66financename],[EA66reason],[EA67amount],[EA67date],[EA67financename],[EA67reason],[EA68amount],[EA68date],[EA68financename],[EA68reason],[EA69amount],[EA69date],[EA69financename],[EA69reason],[EA6amount],[EA6date],[EA6financename],[EA6reason],[EA70amount],[EA70date],[EA70financename],[EA70reason],[EA71amount],[EA71date],[EA71financename],[EA71reason],[EA72amount],[EA72date],[EA72financename],[EA72reason],[EA73amount],[EA73date],[EA73financename],[EA73reason],[EA74amount],[EA74date],[EA74financename],[EA74reason],[EA75amount],[EA75date],[EA75financename],[EA75reason],[EA76amount],[EA76date],[EA76financename],[EA76reason],[EA77amount],[EA77date],[EA77financename],[EA77reason],[EA78amount],[EA78date],[EA78financename],[EA78reason],[EA79amount],[EA79date],[EA79financename],[EA79reason],[EA7amount],[EA7date],[EA7financename],[EA7reason],[EA80amount],[EA80date],[EA80financename],[EA80reason],[EA81amount],[EA81date],[EA81financename],[EA81reason],[EA82amount],[EA82date],[EA82financename],[EA82reason],[EA83amount],[EA83date],[EA83financename],[EA83reason],[EA84amount],[EA84date],[EA84financename],[EA84reason],[EA85amount],[EA85date],[EA85financename],[EA85reason],[EA86amount],[EA86date],[EA86financename],[EA86reason],[EA87amount],[EA87date],[EA87financename],[EA87reason],[EA88amount],[EA88date],[EA88financename],[EA88reason],[EA89amount],[EA89date],[EA89financename],[EA89reason],[EA8amount],[EA8date],[EA8financename],[EA8reason],[EA90amount],[EA90date],[EA90financename],[EA90reason],[EA91amount],[EA91date],[EA91financename],[EA91reason],[EA92amount],[EA92date],[EA92financename],[EA92reason],[EA93amount],[EA93date],[EA93financename],[EA93reason],[EA94amount],[EA94date],[EA94financename],[EA94reason],[EA95amount],[EA95date],[EA95financename],[EA95reason],[EA96amount],[EA96date],[EA96financename],[EA96reason],[EA97amount],[EA97date],[EA97financename],[EA97reason],[EA98amount],[EA98date],[EA98financename],[EA98reason],[EA99amount],[EA99date],[EA99financename],[EA99reason],[EA9amount],[EA9date],[EA9financename],[EA9reason],[EAReportData],[Expended],[FA10amount],[FA10authid],[FA10date],[FA10pepdo],[FA10reason],[FA11amount],[FA11authid],[FA11date],[FA11pepdo],[FA11reason],[FA12amount],[FA12authid],[FA12date],[FA12pepdo],[FA12reason],[FA13amount],[FA13authid],[FA13date],[FA13pepdo],[FA13reason],[FA14amount],[FA14authid],[FA14date],[FA14pepdo],[FA14reason],[FA15amount],[FA15authid],[FA15date],[FA15pepdo],[FA15reason],[FA16amount],[FA16authid],[FA16date],[FA16pepdo],[FA16reason],[FA17amount],[FA17authid],[FA17date],[FA17pepdo],[FA17reason],[FA18amount],[FA18authid],[FA18date],[FA18pepdo],[FA18reason],[FA19amount],[FA19authid],[FA19date],[FA19pepdo],[FA19reason],[FA1amount],[FA1authid],[FA1date],[FA1pepdo],[FA1reason],[FA20amount],[FA20authid],[FA20date],[FA20pepdo],[FA20reason],[FA2amount],[FA2authid],[FA2date],[FA2pepdo],[FA2reason],[FA3amount],[FA3authid],[FA3date],[FA3pepdo],[FA3reason],[FA4amount],[FA4authid],[FA4date],[FA4pepdo],[FA4reason],[FA5amount],[FA5authid],[FA5date],[FA5pepdo],[FA5reason],[FA6amount],[FA6authid],[FA6date],[FA6pepdo],[FA6reason],[FA7amount],[FA7authid],[FA7date],[FA7pepdo],[FA7reason],[FA8amount],[FA8authid],[FA8date],[FA8pepdo],[FA8reason],[FA9amount],[FA9authid],[FA9date],[FA9pepdo],[FA9reason],[FaCTS_New],[FaCTS_Update],[FAReportData],[Finance],[Finance_Section],[Form],[FormName],[INAC],[IncidentRegion],[IssueDate],[OriginalModTime],[ParentUniversalID],[Status],[TaskAuthority],[TaskCategory],[TaskDescription],[TaskDO],[TASKJOURNALVOUCHERTO],[TaskLabelPrinted],[TaskNumber],[TaskNumberRegion],[TaskOrganization],[TaskPhone],[TaskRequestedBy],[TaskTimeLogged],[TaskType],[tmpAuthidCodes],[tmpAuthidNameList],[tmpFAamount],[tmpFAauthid],[tmpFAreason],[Unexpended],[UniversalID])) as PivotTable
