CREATE    VIEW dbo.[Domino_ReporterLive_EAFAmend] AS  SELECT *  FROM (   SELECT j.DocID as Doc_Id, b.Name, ISNULL(b.Text, '') as [Text]   FROM dbo.DominoData j   CROSS APPLY OPENJSON (FormData) a   CROSS APPLY OPENJSON (a.value)    WITH (    [Name] VARCHAR(50)      ,[Text] VARCHAR(MAX)      ,[Values] NVARCHAR(MAX) AS JSON   ) b    where FormName = 'EAFAmend'     and isJson(FormData) =1  ) App  PIVOT   (    MAX([Text])  FOR [Name]IN ([Supplier],[From],[deaths],[TotAmtReq],[EAFNumberC],[Universal_ID],[PREOCNameC],[$REF],[AmdAmtReq],[PREOCExpAuthorizingTime],[TotAmtNTE],[Parent_UNID],[RelatedIncidentNumberC],[ActualName],[$Links],[OriginalModTime],[PREOCEXPAuthorizingSignatureA_1],[PREOCEXPAuthorizingDate],[injuries],[$Revisions],[$UpdatedBy],[PREOCEXPRequestingAgencyC],[RelatedIncident],[Form],[CrAmtReq],[MailSentFlag],[CrAmtNTE],[PEPTaskNumberC],[RelatedIncidentNumber],[ChargeAgencyC],[PREOCEXPAuthorizerPosition],[IncidentDescriptionAmend],[EventLocationC],[PREOC601IncidentDescription],[AmdAmtNTE],[AmendmentNum],[Missing],[RelatedIncidentC])) as PivotTable
