CREATE VIEW EMBCPROD.V_DIST_VIEW (
   GROUP_NAME, 
   GROUP_ID, 
   IS_ENABLED, 
   USER_NAME, 
   FIRST_NAME, 
   LAST_NAME, 
   EMAIL, 
   IS_OWNER, 
   CREATED_BY, 
   MODIFICATION_DATE, 
   STATUS)
AS 
   SELECT 
      D.GROUP_NAME, 
      D.GROUP_ID, 
      D.IS_ENABLED, 
      U.USER_NAME, 
      P.FIRST_NAME, 
      P.LAST_NAME, 
      P.EMAIL, 
      REPT.IS_OWNER, 
      REPT.CREATED_BY, 
      REPT.MODIFICATION_DATE, 
      REPT.STATUS
   FROM 
      (((EMBCPROD.TBL_DISTRIBUTION_GROUP  AS D 
         LEFT OUTER JOIN EMBCPROD.TBL_GROUP_PROFILE  AS UD 
         ON D.GROUP_ID = UD.GROUP_ID) 
         LEFT OUTER JOIN EMBCPROD.TBL_USER  AS U 
         ON UD.PROFILE_ID = U.USER_ID) 
         LEFT OUTER JOIN EMBCPROD.TBL_REPORT  AS REPT 
         ON D.GROUP_ID = REPT.GLOBAL_REPORT_ID) 
         LEFT JOIN EMBCPROD.TBL_PERSONAL_PROFILE  AS P 
         JOIN EMBCPROD.TBL_REPORT  AS RP 
         ON (P.PROFILE_ID = RP.GLOBAL_REPORT_ID AND RP.STATUS = 'A') 
         ON U.PROFILE_ID = RP.REPORT_ID
   WHERE REPT.STATUS IN ( 'A', 'C' )
GO
EXECUTE sp_addextendedproperty @name = N'MS_SSMA_SOURCE', @value = N'EMBCPROD.V_DIST_VIEW', @level0type = N'SCHEMA', @level0name = N'EMBCPROD', @level1type = N'VIEW', @level1name = N'V_DIST_VIEW';

