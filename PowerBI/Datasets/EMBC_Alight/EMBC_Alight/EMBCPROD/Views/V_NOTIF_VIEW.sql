CREATE VIEW EMBCPROD.V_NOTIF_VIEW (
   NOTIFICATION_GROUP_ID, 
   GROUP_NAME, 
   DESCRIPTION, 
   PROFID_ASS_W_GROUP, 
   EMAIL_ADDRESS, 
   SYNCH_ID, 
   REPORT_NAME)
AS 
   SELECT 
      NG.NOTIFICATION_GROUP_ID, 
      NG.GROUP_NAME, 
      NG.DESCRIPTION, 
      NE.PROFILE_ID AS PROFID_ASS_W_GROUP, 
      NE.EMAIL_ADDRESS, 
      NG.SYNCH_ID, 
      RPT1.REPORT_NAME
   FROM 
      (((EMBCPROD.TBL_NOTIFICATION_GROUP  AS NG 
         LEFT JOIN EMBCPROD.TBL_NOTIFICATION_EMAILADDRESS  AS NE 
         ON NE.NOTIFICATION_GROUP_ID = NG.NOTIFICATION_GROUP_ID) 
         LEFT JOIN EMBCPROD.TBL_REPORT  AS RPT1 
         ON RPT1.REPORT_ID = NE.PROFILE_ID) 
         LEFT JOIN EMBCPROD.TBL_USER  AS U 
         ON RPT1.REPORT_ID = U.PROFILE_ID) 
         LEFT JOIN EMBCPROD.TBL_REPORT  AS RPT2 
         ON U.USER_ID = RPT2.REPORT_ID
   WHERE ((RPT1.STATUS = 'A' AND RPT2.STATUS = 'A') OR (NE.PROFILE_ID IS NULL))
GO
EXECUTE sp_addextendedproperty @name = N'MS_SSMA_SOURCE', @value = N'EMBCPROD.V_NOTIF_VIEW', @level0type = N'SCHEMA', @level0name = N'EMBCPROD', @level1type = N'VIEW', @level1name = N'V_NOTIF_VIEW';

